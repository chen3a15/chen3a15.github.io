"use strict";(self["define"]=self["define"]||[]).push([[1171,7442],{81171:function(t,e,s){s.r(e),s.d(e,{default:function(){return A}});var a=s(60017),o=(s(43928),s(77253),s(97791),s(97442)),r=s(22244),n=s(10311);const i={class:"logo"},c={class:"content"},l={class:"title"},u={class:"username"},h={class:"status"};function d(t,e,s,a,o,r){const d=(0,n.resolveComponent)("icon-cocogoat");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(t.$style.syncItemMsft)},[(0,n.createElementVNode)("div",i,[(0,n.createVNode)(d)]),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("div",l,[(0,n.createElementVNode)("div",u,"清心 - "+(0,n.toDisplayString)(t.provider.email),1),(0,n.createElementVNode)("div",h,(0,n.toDisplayString)(t.provider.email),1)])])],2)}var C=s(42053),f=(0,n.defineComponent)({components:{IconCocogoat:C.Z},props:{provider:{type:Object,required:!0}},setup(){return{}}}),m={syncItemMsft:"syncItemMsft-cc4a0b"},w=s(14545);const p={};p["$style"]=m;const g=(0,w.Z)(f,[["render",d],["__cssModules",p]]);var v=g,E=s(99113);const y="/v2/qingxin";class k{constructor(t){(0,a.Z)(this,"data",void 0),(0,a.Z)(this,"token",""),(0,a.Z)(this,"user",""),(0,a.Z)(this,"email",""),(0,a.Z)(this,"gzDisabled",!1),(0,a.Z)(this,"notice",(0,n.ref)("")),(0,a.Z)(this,"component",(0,n.markRaw)(v)),(0,a.Z)(this,"status",(0,n.reactive)({status:r.mA.WAITING,error:null}));try{this.data=t,this.token=t.token,this.email=this.getFromJWT(this.token,"email"),this.user=this.getFromJWT(this.token,"sub"),E.YM.value.reporting&&(s.e(4153).then(s.bind(s,44153)).then((({setUser:t})=>{t(this.email)})),s.e(6493).then(s.bind(s,36493)).then((({setUser:t})=>{t(this.email)})))}catch(e){const t=new r.s9(r.fS.AUTH,"Authorization required",null);throw this.status.status=r.mA.OFFLINE,this.status.error=t,t}}async enabled(){return await(0,o.HU)(),{enabled:""===o.ik.value,reason:o.ik.value}}async info(){const t=await fetch(`${await(0,o.HU)(y)}/${this.user}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}});return await t.json()}gzCompress(t){const e=new Blob([t],{type:"application/json"}),s=new CompressionStream("gzip");return new Response(e.stream().pipeThrough(s)).blob()}noCompress(t){return t}async set(t,e,{localLast:s,localNow:a,forceOverride:n}){const i=null!==e&&!this.gzDisabled&&"CompressionStream"in window?this.gzCompress:this.noCompress,c=await fetch(`${await(0,o.HU)(y)}/${this.user}/${t}${n||0===s.getTime()?"?override":""}`,{method:null===e?"DELETE":"PUT",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json","If-Unmodified-Since":s.toUTCString(),"X-Last-Modified":a.toUTCString(),...i===this.gzCompress?{"Content-Encoding":"gzip"}:{}},body:null===e?void 0:await i(JSON.stringify(e))});if(415===c.status)return this.gzDisabled=!0,await this.set(t,e,{localLast:s,localNow:a,forceOverride:n});if(412===c.status){const e=new r.s9(r.fS.CONFLICT,"conflict when saving ["+t+"]",{localLast:s,remoteLast:new Date(c.headers.get("Last-Modified")||0),localNow:a});throw this.status.status=r.mA.FAILED,this.status.error=e,e}if(401===c.status){const t=new r.s9(r.fS.AUTH,"Authorization required",null);throw this.status.status=r.mA.OFFLINE,this.status.error=t,t}if(404===c.status)return{value:null,lastModified:new Date(0)};if(!c.ok){let t=c.statusText;try{const e=await c.text();t=e;try{const s=JSON.parse(e);s.error&&(t=s.error)}catch(h){}}catch(h){}const e=new r.s9(r.fS.OTHER,t,c);throw this.status.status=r.mA.FAILED,this.status.error=e,e}if(204===c.status)return{value:null,lastModified:a};const l=await c.json(),u=c.headers.get("authorization");return u&&(this.data.token=u.replace("Bearer ",""),this.data.lastModified=Date.now()),{value:e,lastModified:new Date(l.afterLastModified)}}async get(t){const e=await fetch(`${await(0,o.HU)(y)}/${this.user}/${t}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}});if(401===e.status){const t=new r.s9(r.fS.AUTH,"Authorization required",null);throw this.status.status=r.mA.OFFLINE,this.status.error=t,t}if(!e.ok){let t=e.statusText;try{const a=await e.text();t=a;try{const e=JSON.parse(a);e.error&&(t=e.error)}catch(s){}}catch(s){}const a=new r.s9(r.fS.OTHER,t,e);throw this.status.status=r.mA.FAILED,this.status.error=a,a}return{value:await e.json(),lastModified:new Date(e.headers.get("Last-Modified")||0)}}async loadAll(){const t=await fetch(`${await(0,o.HU)(y)}/${this.user}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}});if(!t.ok){let e=t.statusText;try{const s=await t.text();e=s;try{const t=JSON.parse(s);t.error&&(e=t.error)}catch(a){}}catch(a){}const s=new r.s9(r.fS.OTHER,e,t);throw this.status.status=r.mA.FAILED,this.status.error=s,s}const e=t.headers.get("authorization");e&&(this.data.token=e.replace("Bearer ",""),this.data.lastModified=Date.now());const s=await t.json();return Object.keys(s).forEach((t=>{s[t].lastModified=new Date(s[t].lastModified)})),s}getFromJWT(t,e){const s=t.split(".");if(3!==s.length)throw new Error("Invalid token");const a=JSON.parse(atob(s[1]));return a[e]}}var A=k},97442:function(t,e,s){s.d(e,{HU:function(){return u},ik:function(){return c},ts:function(){return n}});var a=s(10311);const o={global:"https://77.cocogoat.work",cn:"https://77.cocogoat.cn"};let r=navigator.language.startsWith("zh")?"cn":"global";const n=(0,a.ref)(""),i=(0,a.ref)("info"),c=(0,a.ref)("");let l;const u=async(t="",e="default")=>(l||(l=h(r),r=await l),await l,o["default"===e?r:e]+t),h=async t=>{const e=await o[t]+"/status";try{const t=await fetch(e);if(t.ok){const e=await t.json();if(n.value=e.msg,i.value=e.typ,c.value=e.smsg,o[e.region])return e.region}}catch(s){return console.error("API Region Probe Faild",s),"global"===t?"cn":"global"}return t}},42053:function(t,e,s){s.d(e,{Z:function(){return h}});var a=s(10311);const o={viewBox:"0 0 204 204"},r=(0,a.createElementVNode)("g",null,[(0,a.createElementVNode)("path",{d:" M 92.79 59.13 C 94.98 55.32 98.53 52.56 101.92 49.88 C 105.14 52.74 108.92 55.30 111.02 59.15 C 110.63 62.49 107.80 65.92 104.21 65.83 C 101.15 65.86 97.27 66.68 95.10 63.91 C 93.97 62.56 92.73 60.98 92.79 59.13 Z"}),(0,a.createElementVNode)("path",{d:" M 82.38 54.26 C 82.72 54.23 83.41 54.17 83.76 54.14 C 86.77 57.18 89.10 60.84 92.29 63.72 C 93.95 65.58 96.89 67.68 95.57 70.52 C 93.68 75.27 90.04 79.03 87.26 83.27 C 85.94 84.91 84.25 87.99 81.72 86.52 C 79.39 83.07 77.68 79.20 75.02 75.95 C 73.64 73.84 70.87 71.42 72.69 68.75 C 75.49 63.69 78.35 58.47 82.38 54.26 Z"}),(0,a.createElementVNode)("path",{d:" M 119.11 54.95 C 120.87 52.96 122.79 55.72 123.89 57.04 C 126.97 61.41 130.22 65.85 132.00 70.92 C 128.93 76.45 124.76 81.37 121.83 87.03 C 121.20 86.96 119.95 86.83 119.33 86.77 C 116.16 82.55 113.06 78.28 110.00 73.99 C 108.50 71.78 106.78 68.39 109.16 66.15 C 112.65 62.58 116.01 58.89 119.11 54.95 Z"}),(0,a.createElementVNode)("path",{d:" M 51.82 63.56 C 58.70 63.02 64.12 67.97 68.08 72.99 C 72.28 77.62 75.21 83.19 78.32 88.57 C 80.70 92.48 79.50 97.42 81.68 101.44 C 84.44 88.13 95.06 78.87 101.41 67.39 C 103.21 69.06 104.59 71.10 105.93 73.15 C 111.83 81.55 119.56 89.46 121.42 99.94 C 121.88 99.79 122.79 99.50 123.25 99.35 C 123.62 95.93 123.59 92.31 125.30 89.22 C 129.75 80.82 134.83 72.41 142.47 66.52 C 145.21 64.40 148.62 63.50 152.06 63.57 C 150.18 68.18 148.61 72.98 148.91 78.04 C 148.87 91.80 143.22 105.66 132.73 114.74 C 129.22 118.10 124.49 120.51 122.54 125.21 C 127.83 124.55 132.04 121.10 136.38 118.32 C 145.39 112.57 154.03 106.14 161.79 98.78 C 167.77 93.07 171.20 85.51 174.16 77.96 C 176.45 77.74 177.07 80.44 178.09 81.97 C 181.72 88.26 181.50 95.83 180.67 102.81 C 179.03 109.41 175.27 115.68 169.55 119.51 C 161.87 124.32 153.00 127.10 143.98 127.83 C 140.96 128.00 137.94 128.52 135.19 129.85 C 136.01 134.37 136.26 139.44 133.24 143.26 C 129.03 150.23 118.48 151.96 112.25 146.74 C 108.03 143.08 106.71 137.40 103.80 132.82 C 102.28 133.14 100.11 132.48 99.28 134.22 C 96.79 138.38 95.66 143.53 91.73 146.71 C 87.38 150.49 80.82 150.55 75.80 148.14 C 72.69 146.31 70.33 143.26 68.96 139.95 C 67.64 136.66 68.75 133.04 68.04 129.67 C 65.75 128.01 62.69 128.23 60.02 127.83 C 51.21 127.21 42.64 124.39 35.05 119.91 C 28.95 116.19 24.96 109.66 23.29 102.82 C 22.58 95.83 22.21 88.24 25.83 81.92 C 26.84 80.41 27.51 77.79 29.76 77.99 C 31.70 81.87 32.72 86.19 35.15 89.83 C 41.41 100.09 51.57 106.93 61.00 113.98 C 67.60 117.93 73.49 123.71 81.26 125.19 C 79.42 120.47 74.79 118.01 71.24 114.75 C 60.50 105.43 54.82 91.11 55.06 76.99 C 55.35 72.26 53.43 67.89 51.82 63.56 M 72.72 129.22 C 72.52 135.00 78.56 138.93 83.85 138.62 C 87.70 138.20 90.56 135.35 93.11 132.70 C 87.27 128.33 79.61 128.62 72.72 129.22 M 110.90 132.29 C 112.59 134.55 114.51 136.81 117.21 137.86 C 123.13 140.54 131.06 135.91 131.17 129.27 C 124.29 128.39 117.05 128.76 110.90 132.29 Z"})],-1),n=[r];function i(t,e){return(0,a.openBlock)(),(0,a.createElementBlock)("svg",o,n)}var c=s(14545);const l={},u=(0,c.Z)(l,[["render",i]]);var h=u}}]);